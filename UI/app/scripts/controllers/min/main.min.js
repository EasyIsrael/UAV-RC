"use strict";angular.module("uavRcApp").controller("MainCtrl",function(t,e){var a=L.map("map").setView([48.084730529496646,11.279869079589842],17);L.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(a),a.on("click",function(t){({latitude:t.latlng.lat,longitude:t.latlng.lng,height:20})});var n=new L.FeatureGroup;a.addLayer(n);var o=new L.Control.Draw({draw:{polyline:{shapeOptions:{color:"#f357a1",weight:10}},polygon:{allowIntersection:!1,drawError:{color:"#e1e100",message:"<strong>Oh snap!<strong> you can't draw that!"},shapeOptions:{color:"#bada55"}},circle:!1,rectangle:!1,marker:{}},edit:{featureGroup:n}});a.addControl(o);var r;a.on("draw:created",function(t){var e=t.layerType,a=t.layer;"polyline"===e&&(r=a.getLatLngs(),c=0,u()),n.addLayer(a)});var l=L.divIcon({iconSize:[70,70],className:"uav"}),i=L.marker([48.084730529496646,11.279869079589842],{draggable:!0,icon:l}).addTo(a).on("dragend",function(){var t={GPS_DATA:{latitude:i._latlng.lat,longitude:i._latlng.lng,height:0}};e.emit("_SET",t)}),d=document.getElementById("falcon");i._icon.appendChild(d),e.forward("GPS_DATA",t),e.forward("connect",t),t.goto={latitude:0,longitude:1e-4,height:50};var g,c=0,u=function(){if(c!=r.length){g=r[c++];var t={latitude:g.lat,longitude:g.lng,height:20};e.emit("COMMAND_GOTO",t)}};t.send=function(){e.emit("COMMAND_GOTO",t.goto)},t.$on("socket:connect",function(){var t={GPS_DATA:{latitude:48.084730529496646,longitude:11.279869079589842,height:0}};e.emit("_SET",t)}),t.$on("socket:GPS_DATA",function(t,e){var a=L.latLng(e.latitude,e.longitude);a.distanceTo(g)<5&&u(),i.setLatLng(a),d.style["-webkit-transform"]="rotate("+(180+e.heading)%360+"deg)"})});